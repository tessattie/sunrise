SELECT c.id, c.last_name, (SELECT SUM(s.total) FROM sales s WHERE customer_id = c.id AND (s.status = 0 OR s.status = 4 OR s.status = 6 OR s.status = 7) GROUP BY c.id ORDER BY c.id) as purchased, (SELECT SUM(p.amount) FROM payments p WHERE customer_id = c.id GROUP BY c.id ORDER BY c.id) as paid FROM customers c WHERE c.id = 256